---
layout: home
title: "Integrating Payment Gateways in Ruby on Rails"
date: 2025-01-17
categories: "Ruby On Rails"
tags: [Ruby On Rails, ROR, Payments, Payment Gateways, PayPal, Strips, Razorpay]
image: 'https://github.com/user-attachments/assets/637bc34c-22b2-4923-acab-d9c20c7a09a4'
---

# ğŸ’³ Unlocking Payments: Integrating Payment Gateways in Ruby on Rails ğŸš€

In the modern web world, online transactions have become a cornerstone for e-commerce and service-based platforms. Setting up payment gateways might seem daunting, but Ruby on Rails (RoR) makes it streamlined and efficient. This blog dives into popular payment gateways and explains how to implement them with code examples, covering payment processing and refund initialization.

![image-1570007044997-813127114d2d6471a505ecde09096475](https://github.com/user-attachments/assets/637bc34c-22b2-4923-acab-d9c20c7a09a4)

---

## ğŸŒŸ Popular Payment Gateways for Ruby on Rails

Here are some of the most commonly used payment gateways with RoR:

1. **Stripe** ğŸ§¡
2. **PayPal** ğŸ›¡ï¸
3. **Razorpay** ğŸ‡®ğŸ‡³
4. **Square** ğŸ”³

---

## ğŸ’¡ Setting Up a Payment Gateway in Rails

Letâ€™s walk through the process of integrating **Stripe** as an example.

---

### ğŸ› ï¸ Step 1: Install the Required Gem

Add the Stripe gem to your `Gemfile`:

```ruby
gem 'stripe'
```

Run:

```bash
bundle install
```

---

### ğŸ”‘ Step 2: Configure Stripe API Keys

Create a new initializer file, `config/initializers/stripe.rb`:

```ruby
Stripe.api_key = ENV['STRIPE_SECRET_KEY']
```

Set your API keys in `.env`:

```env
STRIPE_SECRET_KEY=your_secret_key
STRIPE_PUBLISHABLE_KEY=your_publishable_key
```

---

### ğŸ“„ Step 3: Create a Payment Form

In your `views/payments/new.html.erb`, add a simple payment form:

```erb
<h1>Make a Payment ğŸ’µ</h1>

<form action="/payments" method="POST">
  <script src="https://checkout.stripe.com/checkout.js"
          class="stripe-button"
          data-key="<%= ENV['STRIPE_PUBLISHABLE_KEY'] %>"
          data-amount="5000"  <!-- Amount in cents -->
          data-name="My Shop"
          data-description="Payment for your order"
          data-currency="usd">
  </script>
</form>
```

---

### ğŸ”„ Step 4: Handle the Payment Request

Create a PaymentsController to handle payments:

```ruby
class PaymentsController < ApplicationController
  def create
    # Token is generated by Stripe Checkout
    token = params[:stripeToken]

    begin
      charge = Stripe::Charge.create(
        amount: 5000, # Amount in cents
        currency: 'usd',
        source: token,
        description: 'Payment for order #1234'
      )
      flash[:success] = "Payment successful! ğŸ‰"
    rescue Stripe::CardError => e
      flash[:error] = e.message
    end

    redirect_to root_path
  end
end
```

---

## ğŸ” Initializing a Refund

Refunds are just as easy to implement:

```ruby
def refund
  begin
    refund = Stripe::Refund.create(
      charge: 'charge_id_here' # Replace with the actual charge ID
    )
    flash[:success] = "Refund processed successfully! ğŸ’¸"
  rescue Stripe::InvalidRequestError => e
    flash[:error] = e.message
  end

  redirect_to root_path
end
```

---

## ğŸ¦ Other Payment Gateways

Hereâ€™s how to integrate other gateways briefly:

### ğŸ”µ **PayPal**

- Install the `paypal-sdk-rest` gem.
- Use the PayPal REST API for payments and refunds.
- Create a payment URL and redirect the user to complete the payment.

### ğŸ‡®ğŸ‡³ **Razorpay**

- Install the `razorpay` gem.
- Use its APIs for creating orders, capturing payments, and initiating refunds.

### ğŸ”³ **Square**

- Install the `square` gem.
- Use its APIs for creating checkout links and processing refunds.

---

## ğŸ“ˆ Best Practices for Payment Gateways

1. **Secure your API keys** ğŸ›¡ï¸ â€“ Never expose secret keys.
2. **Validate inputs** âœ… â€“ Sanitize and validate all payment-related data.
3. **Handle errors gracefully** ğŸš¨ â€“ Always provide a fallback plan for failed transactions.
4. **Use webhooks** ğŸ”” â€“ Get real-time updates about payment statuses.

---

## ğŸš€ Wrapping Up

Integrating payment gateways into your Ruby on Rails application is essential for any modern web app. By following the steps outlined above, you can set up a seamless payment experience for your users, process payments, and even handle refunds.

Have questions or want to share your payment integration experiences? Drop them in the comments below! ğŸ’¬
